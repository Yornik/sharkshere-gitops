repoURL: https://github.com/Yornik/sharkshere-gitops.git
targetRevision: main

# Define your apps here. Each entry becomes an ArgoCD Application.
#
# To add a new app:
#   1. Add an entry below
#   2. Create its manifests under manifests/<name>/
#   3. Push â€” ArgoCD picks it up automatically
#
apps:
  example-app:
    namespace: example
    path: manifests/example-app

  local-path-provisioner:
    namespace: local-path-storage
    path: manifests/local-path-provisioner

  smb-csi-driver:
    namespace: kube-system
    helm:
      repoURL: https://raw.githubusercontent.com/kubernetes-csi/csi-driver-smb/master/charts
      chart: csi-driver-smb
      targetRevision: "v1.*"
      values: |
        controller:
          replicas: 1

  external-dns:
    namespace: external-dns
    path: manifests/external-dns

  jellyfin:
    namespace: jellyfin
    path: manifests/jellyfin

  democratic-csi:
    namespace: democratic-csi
    path: manifests/democratic-csi

  democratic-csi-nfs:
    namespace: democratic-csi
    helm:
      repoURL: https://democratic-csi.github.io/charts/
      chart: democratic-csi
      targetRevision: "*"
      values: |
        csiDriver:
          name: org.democratic-csi.nfs
        driver:
          existingConfigSecret: democratic-csi-nfs-driver-config
          config:
            driver: freenas-api-nfs
        storageClasses:
          - name: truenas-nfs
            defaultClass: true
            reclaimPolicy: Delete
            allowVolumeExpansion: true
            parameters:
              fsType: nfs
            mountOptions:
              - noatime
              - nfsvers=4
        volumeSnapshotClasses: []

  democratic-csi-iscsi:
    namespace: democratic-csi
    helm:
      repoURL: https://democratic-csi.github.io/charts/
      chart: democratic-csi
      targetRevision: "*"
      values: |
        csiDriver:
          name: org.democratic-csi.iscsi
        node:
          hostPID: true
          driver:
            extraEnv:
              - name: ISCSIADM_HOST_STRATEGY
                value: nsenter
              - name: ISCSIADM_HOST_PATH
                value: /usr/local/sbin/iscsiadm
            iscsiDirHostPath: /etc/iscsi
            iscsiDirHostPathType: ""
        driver:
          existingConfigSecret: democratic-csi-iscsi-driver-config
          config:
            driver: freenas-api-iscsi
        storageClasses:
          - name: truenas-iscsi
            defaultClass: false
            reclaimPolicy: Delete
            allowVolumeExpansion: true
            parameters:
              fsType: ext4
            mountOptions: []
        volumeSnapshotClasses: []
