apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: fail2ban-grafana
  namespace: monitoring
spec:
  plugin:
    fail2ban:
      rules:
        # Only auth-related failures should count for Grafana bans.
        statuscode: "401-403"
        maxretry: 10
        findtime: 10m
        bantime: 30m
        enabled: "true"
